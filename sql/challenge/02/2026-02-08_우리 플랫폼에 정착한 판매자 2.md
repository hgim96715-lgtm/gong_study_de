---
tags:
  - SQL_TEST
related:
  - "[[SQL_DISTINCT_vs_GROUP_BY]]"
source: solvesql
difficulty:
  - Lv.2
status:
  - π© ν•΄κ²°
---
##  ν•΄κ²° μ „λµ (Code Before Think)

> μƒν’ κ°€κ²©μ΄ 50λ‹¬λ¬ μ΄μƒμΈ μ£Όλ¬Έμ΄ 100κ±΄ μ΄μƒ λ“¤μ–΄μ¨ νλ§¤μ λ¦¬μ¤νΈλ¥Ό μ£Όλ¬Έ κ±΄μκ°€ λ§μ€ μμ„λ€λ΅ μ¶λ ¥ν•λ” μΏΌλ¦¬λ¥Ό μ‘μ„±ν•΄μ£Όμ„Έμ”.


1. **νƒ€κ² λ°μ΄ν„°:** (μ–΄λ–¤ ν…μ΄λΈ”μ—μ„ λ¬΄μ—‡μ„ λ½‘μ•„μ•Ό ν•λ”κ°€?)
   - `olist_order_items_dataset` : μƒν’ λ‹¨μ„μ λ°μ΄ν„°
   - `Β price` : κ°€κ²©
   - `Β seller_id` : νλ§¤μ ID
   - `Β order_id` : μ£Όλ¬Έ ID
1. **μ΅°κ±΄ λ¶„μ„:**
   -  νλ§¤μ λ¦¬μ¤νΈ > seller_id λ΅ λ¬¶κΈ°
   - κ°€κ²©μ΄ 50λ‹¬λ¬ μ΄μƒ μ΅°κ±΄
   -  μ£Όλ¬Έμ΄ 100κ±΄μ΄μƒ 
1. **μ‚¬μ©ν•  λ¬Έλ²•:**
   - GROUP BY
   - HAVING
   - WHERE
---
## μ •λ‹µ μΏΌλ¦¬ (Solution)

```sql
SELECT seller_id,COUNT(DISTINCT order_id) as orders
FROM olist_order_items_dataset
WHERE price >=50
GROUP BY seller_id
HAVING COUNT(DISTINCT order_id)>=100
ORDER BY orders DES
```

---
##  μ¤λ‹µ λ…ΈνΈ & λ°°μ΄ μ  (Retrospective)

-  **λ‚΄κ°€ μ‹¤μν• λ¶€λ¶„:**
	- `olist_order_items_dataset` κ°€ **μƒν’ λ‹¨μ„ ν…μ΄λΈ”**λΌλ” μ μ„ λ†“μΉ¨
	- `COUNT(order_id)` λ¥Ό μ‚¬μ©ν•΄ **μ£Όλ¬Έ κ±΄μ**κ°€ μ•„λ‹λΌ **μ£Όλ¬Έμ— ν¬ν•¨λ μƒν’ ν–‰ μ**λ¥Ό μ„Έκ³  μμ—μ
-  **μƒλ΅ μ•κ² λ ν•¨μ/κΏ€ν:**
	- μ§‘κ³„ μ „μ— λ°λ“μ‹ β€μ΄ ν…μ΄λΈ”μ 1 row λ” λ¬΄μ—‡μ„ μλ―Έν•λ”κ°€?β€λ¥Ό λ¨Όμ € ν™•μΈν•΄μ•Ό ν•¨

---
## λ” λ‚μ€ ν’€μ΄κ°€ μλ‹¤λ©΄?

```sql
-- λ” λ‚μ€ ν’€μ΄κ°€ μμ„κ²½μ° 
```
