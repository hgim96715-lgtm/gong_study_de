---
tags:
  - SQL_TEST
related:
  - "[[SubQuery_CTE]]"
  - "[[SQL_JOIN_Concept]]"
source: solvesql
difficulty:
  - Lv.2
status: 🟨 힌트참고
---
##  해결 전략 (Code Before Think)

> 요일별 매출액 합계를 구하고, 매출이 1500 달러 이상인 요일의 결제 내역을 모두 출력하는 쿼리를 작성해주세요.
> 쿼리 결과에는 `tips` 테이블에 있는 모든 컬럼이 포함되어야 합니다.

1. **타겟 데이터:** (어떤 테이블에서 무엇을 뽑아야 하는가?)
   - `tips` 테이블
   - `day` :요일
   - `total_bill` : 식사합계($)
1. **조건 분석:**
   - 요일별 
   - 매출 합계
   - 매출 1500달러 이상
1. **사용할 문법:**
   - GROUP BY
   - HAVING
   - SUM
---
## 정답 쿼리 (Solution)

```sql
-- 여기에 작성한 쿼리를 붙여넣으세요.
WITH sum_bill AS(
SELECT SUM(total_bill) AS day_total,
day
FROM tips
GROUP BY day
HAVING SUM(total_bill)>=1500
)

SELECT t.*
FROM tips t
JOIN sum_bill sb ON t.day=sb.day
```

---
##  오답 노트 & 배운 점 (Retrospective)

-  **내가 실수한 부분:**
	- JOIN은 **항상 id(기본키)** 로만 해야 한다고 생각했다

-  **새로 알게 된 함수/꿀팁:**
	- JOIN은 id가 없어도 된다, **의미적으로 같은 컬럼**이면 JOIN 가능
	- `SELECT t.*`로 **원본 데이터 전체 출력**
	- JOIN 기준은 ‘고유성’이 아니라 ‘관계’ > id → 1:1 관계일 때 주로 사용, day 같은 컬럼 → 1:N 관계에서도 매우 흔함

> JOIN은 PK가 아니라 “같은 의미를 가진 컬럼”으로 한다.  
>집계 쿼리는 필터용, 원본 테이블은 출력용이다.

---
## 더 나은 풀이가 있다면?

```sql
-- 더 나은 풀이가 있을경우 
```
