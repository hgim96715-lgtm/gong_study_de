---
tags:
  - SQL_TEST
related:
  - "[[Aggregation_GROUP_BY]]"
source: solvesql
difficulty:
  - Lv.2
status: 🟩 해결
---
##  해결 전략 (Code Before Think)

> 2021년 2월 정기점검 대상 자전거를 추출하려고 합니다. 
> `rental_history` 테이블을 사용해 2021년 1월 한 달간 총 주행 거리가 50km 이상인 자전거의 ID를 출력하는 쿼리를 작성해주세요.

1. **타겟 데이터:** (어떤 테이블에서 무엇을 뽑아야 하는가?)
   - `rental_history` 테이블
   - ` bike_id` : 자전거 ID
   - `distance` : 주행거리(m)
   - ` return_at` : 반납시각
   - `rent_at` :대여시각
1. **조건 분석:**
   - 2021년 1월 한달간 
   - 50km 이상 
   - 반납시각 -대여시각????
1. **사용할 문법:**
   - WHERE
---
## 정답 쿼리 (Solution)

```sql
-- 여기에 작성한 쿼리를 붙여넣으세요.
SELECT bike_id
FROM rental_history
WHERE return_at>='2021-01-01' AND return_at<'2021-02-01'
GROUP BY bike_id
HAVING SUM(distance)>=50000
```

---
##  오답 노트 & 배운 점 (Retrospective)

-  **내가 실수한 부분:**
	- 처음에 `distance >= 5000`처럼 **개별 대여 기록 기준으로 조건을 걸었다**
	- 문제는 **자전거별 총 주행 거리**를 묻고 있었음 >  `SUM(distance)`를 떠올리지 못했다

-  **새로 알게 된 함수/꿀팁:**

---
## 더 나은 풀이가 있다면?

```sql
-- 더 나은 풀이가 있을경우 
```
