---
tags:
  - SQL_TEST
related:
  - "[[00_SQL_Challenge_DashBoard]]"
  - "[[SQL_JOIN_Concept]]"
  - "[[Aggregation_GROUP_BY]]"
source: solvesql
difficulty:
  - Lv.2
status: 🟧 복습
---
##  해결 전략 (Code Before Think)

> 대여 매출이 높았던 상위 5명의 배우를 추리고 특별 코너를 만들어 프로모션에 활용하려고 합니다. 
> 데이터베이스를 조회해 배우별 대여 매출 합계를 계산하고, 그 중 상위 5명의 정보를 출력하는 쿼리를 작성해주세요. 
> 배우별 대여 매출 합계는 배우가 출연한 작품들의 매출 합계입니다.

1. **타겟 데이터:** (어떤 테이블에서 무엇을 뽑아야 하는가?)
   - `actor`테이블
	   - `first_name` 배우 이름 (이름)
	   - ` last_name` 배우 이름 (성)
	   - `actor_id` 배우ID
   - `payment` 테이블
	   - `amount` : 실제 대여 매출 금액
- `rental` 테이블
	- `rental_id` : 결제 ↔ 대여 연결
- `inventory` 테이블
	- `inventory_id` : 대여 ↔ 영화 연결
	- `film_id` : 어떤 영화인지 식별
- `film_actor` 테이블
	- `film_id` : 영화 ID
	- `actor_id` : 배우 ID
1. **조건 분석:**
   - 
3. **사용할 문법:**
   - `JOIN`
   - SUM()
   - GROUP BY
   - ORDER BY
   - LIMIT
---
## 정답 쿼리 (Solution)

```sql
-- 여기에 작성한 쿼리를 붙여넣으세요.
SELECT
	a.first_name,
	a.last_name,
	SUM(p.amount) AS total_revenue
FROM payment p
JOIN rental r ON p.rental_id=r.rental_id
JOIN inventory i ON r.inventory_id=i.inventory_id
JOIN film_actor fa ON i.film_id=fa.film_id
JOIN actor a ON fa.actor_id=a.actor_id
GROUP BY
	a.actor_id,
	a.first_name,
	a.last_name
ORDER BY total_revenue DESC
LIMIT 5;
```

---
##  오답 노트 & 배운 점 (Retrospective)

-  **내가 실수한 부분:**
	- 어떻게 해야할지 막막했다. JOIN을 어떻게 해야하지?
	- 생각해보니 amount중요하니깐 amount 해놓고 amount부터 천천히 join해나가면 더 쉬웠을 거라는 생각이들었다.
    
-  **새로 알게 된 함수/꿀팁:**


---
## 더 나은 풀이가 있다면?

```sql
-- 더 나은 풀이가 있을경우 
```
