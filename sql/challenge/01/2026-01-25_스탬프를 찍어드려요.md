---
aliases: []
tags:
  - SQL_TEST
related:
  - "[[SQL_CASE_WHEN]]"
source: solvesql
difficulty:
  - Lv.2
status: 🟩 해결
---
##  해결 전략 (Code Before Think)

> 스탬프 제도는 영수 금액이 25달러 이상인 경우 스탬프를 2개, 영수 금액이 15달러 이상인 경우 1개, 이외에는 스탬프를 찍어주지 않는 규칙으로 운영될 예정입니다.
> 과거의 영수증 데이터를 기반으로 스탬프가 얼마나 발급될지 미리 확인 해보려고 합니다.
> 각 영수증이 받을 스탬프 개수를 계산한 다음, 스탬프 개수 별로 영수증 개수를 집계하는 쿼리를 작성
> 쿼리 결과는 스탬프 개수 기준 오름차순으로 정렬되어 있어야 하고, 아래 두 컬럼을 포함해야합니다
> - `stamp`: 스탬프 개수,  `count_bill`: 영수증 개수

1. **타겟 데이터:** (어떤 테이블에서 무엇을 뽑아야 하는가?)
   -  tips 테이블 
2. **사용 컬럼 :**
  - `total_bill` (영수 금액 → 스탬프 계산 기준)
3. **조건 분석:**
  -  **스탬프 지급 규칙**
    - `total_bill >= 25` → 스탬프 **2개**
    - `total_bill >= 15` → 스탬프 **1개**
    - 그 외 → 스탬프 **0개**
  - **각 영수증별로 스탬프 개수를 계산**
  - **스탬프 개수별로 영수증 개수 집계**
  - **스탬프 개수 기준 오름차순 정렬**
1. **사용할 문법:**
   - `CASE WHEN ... THEN ... ELSE ... END` 
   - COUNT
   - GROUP BY
   - ORDER BY
---
## 정답 쿼리 (Solution)

```sql
-- 여기에 작성한 쿼리를 붙여넣으세요.
SELECT
  CASE
    WHEN total_bill >= 25 THEN 2
    WHEN total_bill >= 15 THEN 1
    ELSE 0
  END AS stamp,
  COUNT(total_bill) AS count_bill
FROM tips
GROUP BY stamp
ORDER BY stamp ASC;
```

---
##  오답 노트 & 배운 점 (Retrospective)

-  **내가 실수한 부분:**
    
-  **새로 알게 된 함수/꿀팁:**

---
## 더 나은 풀이가 있다면?

```sql
-- 더 나은 풀이가 있을경우 
```
